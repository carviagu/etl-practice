import pandas as pd
hipotecas = pd.read_csv('etl/data/hipotecas/hipotecas_lectura')
import pandas as pd
hipotecas = pd.read_csv('etl/data/hipotecas/hipotecas_lectura')
hipotecas = pd.read_csv('./etl/data/hipotecas/hipotecas_lectura')
hipotecas = pd.read_csv('etl/data/hipotecas/hipotecas_lectura')
hipotecas = pd.read('etl/data/hipotecas/hipotecas_lectura')
reticulate::repl_python()
knitr::opts_chunk$set(echo = TRUE)
reticulate::repl_python()
conn <- DBI::dbConnect(RSQLite::SQLite(), '../data/pets.sqlite')
DBI::dbListTables(conn)
DBI::dbListFields(conn, 'Owners')
DBI::dbListFields(conn, 'Pets')
query <- "
SELECT o.OwnerID, count(p.PetID)
FROM Owners o INNER JOIN Pets p ON(o.OwnerID == p.OwnerID)
GROUP BY o.OwnerID
HAVING count(p.PetID) > 1
"
table <- tbl(conn, sql(query))
table %>% collect() # will execute the query
conn <- DBI::dbConnect(RSQLite::SQLite(), '../data/pets.sqlite')
DBI::dbListTables(conn)
DBI::dbListFields(conn, 'ProceduresHistory')
query <- "
SELECT o.OwnerID, count(p.PetID)
FROM Owners o INNER JOIN Pets p ON(o.OwnerID == p.OwnerID)
GROUP BY o.OwnerID
HAVING count(p.PetID) > 1
"
table <- tbl(conn, sql(query))
table %>% collect() # will execute the query
DBI::dbListFields(conn, 'ProceduresDetails')
DBI::dbListFields(conn, 'ProceduresHistory')
conn <- DBI::dbConnect(RSQLite::SQLite(), '../data/pets.sqlite')
DBI::dbListTables(conn)
DBI::dbListFields(conn, 'ProceduresDetails')
DBI::dbListFields(conn, 'ProceduresHistory')
query <- "
SELECT h.date, AVG(d.price)
FROM ProceduresHistory h INNER JOIN ProceduresDetails d
ON(h.ProcedureType == d.ProcedureType AND
h.ProcedureSubCode == d.ProcedureSubCode)
GROUP BY h.date
"
table <- tbl(conn, sql(query))
table %>% collect() # will execute the query
conn <- DBI::dbConnect(RSQLite::SQLite(), '../data/pets.sqlite')
DBI::dbListTables(conn)
DBI::dbListFields(conn, 'ProceduresDetails')
DBI::dbListFields(conn, 'ProceduresHistory')
query <- "
SELECT h.date, AVG(d.price)
FROM ProceduresHistory h INNER JOIN ProceduresDetails d
ON(h.ProcedureType == d.ProcedureType AND
h.ProcedureSubCode == d.ProcedureSubCode)
GROUP BY h.date
"
table <- tbl(conn, sql(query))
table %>% collect() # will execute the query
reticulate::repl_python()
